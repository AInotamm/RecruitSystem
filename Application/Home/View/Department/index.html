        <include file="Layout:header" />
        <link rel="stylesheet" href="__PUBLIC__/css/department.css">
        <script src="__PUBLIC__/js/department.js"></script>
        <include file="Layout:slider" />
        <div id="page-wrapper">

            <div class="page-content">
                <div class="row">
                    <div class="col-lg-12">
                        <div class="screen">
                            <i class="fa fa-unsorted upAndDown"></i>
                            <ul id="tableactiondTab" class="nav nav-tabs">
                                <li class="active">
                                    <a href="#table_p" data-toggle="tab">{$firstdepa.department}</a></li>
                                <volist name = "org_name" id = "org_name">
                                    <li><a href="#table-{$org_name.use_id}" data-toggle="tab">{$org_name.department}</a></li>
                                </volist>
                                <li><a href="#table" data-toggle="tab">关于本部门</a></li>
                                <li><button type="button" data-target="#modal-add-department" data-toggle="modal" class="btn btn-default glyphicon glyphicon-plus" style="font-size: 16px;background-color: transparent;border-color: transparent;"></button></li>
                            </ul>
                        </div>
                        <div id="tableactionTabContent" class="tab-content">
                            <div id="table_p" class="tab-pane fade active in">
                                <div class="row">
                                    <div class="col-lg-12">
                                        <div class="table-container">
                                            <table class="table table-hover">
                                                <thead>
                                                    <tr>
                                                        <th>职位</th>
                                                        <th>学号</th>
                                                        <th>姓名</th>
                                                        <th>性别</th>
                                                        <th>手机号</th>
                                                        <th>学院</th>
                                                        <th width="60px">操作</th>
                                                    </tr>
                                                </thead>
                                                <tbody>
                                                    <volist name = "first_meminfo" id ="first_meminfo">
                                                        <tr>
                                                            <td>部长</td>
                                                            <td>{$first_meminfo.studentnum}</td>
                                                            <td>{$first_meminfo.name}</td>
                                                            <td>{$first_meminfo.gender}</td>
                                                            <td>{$first_meminfo.phone}</td>
                                                            <td>{$first_meminfo.academy}</td>
                                                            <td></td>
                                                        </tr>
                                                    </volist>
                                                </tbody>
                                            </table>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <volist name = "org_name" id = "org_name">
                                <div id="table-{$org_name.use_id}" class="tab-pane fade active in">
                                    <div class="row">
                                        <div class="col-lg-12">
                                            <div class="table-container">
                                                <table class="table table-hover">
                                                    <thead>
                                                        <tr>
                                                            <th>职位</th>
                                                            <th>学号</th>
                                                            <th>姓名</th>
                                                            <th>性别</th>
                                                            <th>手机号</th>
                                                            <th>学院</th>
                                                            <th width="60px">操作</th>
                                                        </tr>
                                                    </thead>
                                                    <tbody>
                                                        212123213
                                                        <!-- <volist name = "first_meminfo" id ="first_meminfo">
                                                            <tr>
                                                                <td>部长</td>
                                                                <td>{$first_meminfo.studentnum}</td>
                                                                <td>{$first_meminfo.name}</td>
                                                                <td>{$first_meminfo.gender}</td>
                                                                <td>{$first_meminfo.phone}</td>
                                                                <td>{$first_meminfo.academy}</td>
                                                                <td></td>
                                                            </tr>
                                                        </volist> -->
                                                    </tbody>
                                                </table>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </volist>
                            <div id="table" class="tab-pane fade">
                                <div class = "row">
                                <div class="panel panel-grey">
                                <div class="panel-heading">部门简介</div>
                                    <div class="panel-body pan">
                                        <form action="{:U('Department/addContent')}" method = "post">
                                                <div class="form-group">
                                                    <textarea rows="8" placeholder="简介" class="form-control" maxlength = "255" name = "intro_content"></textarea>
                                                </div>
    <!--                                             <div class="row">
                                                    <div class="col-md-9">
                                                        <div class="form-group">
                                                            <input id="inputCardNumber" type="text" placeholder="Card number" class="form-control" />
                                                        </div>
                                                    </div>
                                                </div> -->
                                   
                                        <div class="form-actions text-right pal">
                                            <button type="submit" class="btn btn-primary">提交</button>
                                        </div>
                                    </form>
                                     </div>
                                </div>
                            </div>
                            <button type="button" data-target="#modal-add-people" data-toggle="modal" class="btn btn-default" style="margin:auto;background-color: #fff;">人员添加</button>
                        </div>
                        </div>
                        <div id="modal-add-people" tabindex="-1" role="dialog" aria-labelledby="modal-prompt-label" aria-hidden="true" class="modal fade" style="display: none;">
                            <div class="modal-dialog">
                                <div class="modal-content">
                                    <div class="modal-header">
                                        <button type="button" data-dismiss="modal" aria-hidden="true" class="close">×</button>
                                        <h4 id="modal-prompt-label" class="modal-title">新人员添加</h4>
                                    </div>
                                    <div class="modal-body">
                                        <form action="#" class="form-horizontal">
                                            <div class="form-body pal">
                                                <div class="form-group">
                                                    <label for="department" class="col-md-3 control-label">部门</label>
                                                    <div class="col-md-9">
                                                        <div class="input-icon right">
                                                            <select class="form-control" id="department" style="height: 31px;font-size: 12px;">
                                                                <volist  name ="add_depa" id = "add_depa">
                                                                    <option value = "{$add_depa.id}">{$add_depa.department}</option>
                                                                </volist>
                                                            </select>
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="form-group">
                                                    <label for="job" class="col-md-3 control-label">职位</label>
                                                    <div class="col-md-9">
                                                        <div class="input-icon right">
                                                            <select class="form-control" id="position" style="height: 31px;font-size: 12px;">
                                                                <option value = "5">部长</option>
                                                                <option value = "4">副部长</option>
                                                                <option value = "3">干事</option>
                                                                <option value = "2">学员</option>
                                                            </select>
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="form-group">
                                                    <label for="studentID" class="col-md-3 control-label">学号</label>
                                                    <div class="col-md-9">
                                                        <div class="input-icon right">
                                                            <input id="studentID" type="text" placeholder="输入需要新添加人员的学号" class="form-control" style="height: 31px;font-size: 12px;-webkit-border-radius:4px !important;-moz-border-radius: 4px !important;border-radius: 4px !important">
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="form-group">
                                                    <p class="col-md-3 control-label">姓名</p>
                                                    <p class="col-md-9 control-label" style="text-align: left"></p>
                                                </div>
                                                <div class="form-group">
                                                    <p class="col-md-3 control-label">性别</p>
                                                    <p class="col-md-9 control-label" style="text-align: left"></p>
                                                </div>
                                                <div class="form-group">
                                                    <p class="col-md-3 control-label">手机号</p>
                                                    <p class="col-md-9 control-label" style="text-align: left"></p>
                                                </div>
                                                <div class="form-group">
                                                    <p class="col-md-3 control-label">学院</p>
                                                    <p class="col-md-9 control-label" style="text-align: left"></p>
                                                </div>
                                            </div>
                                        </form>
                                    </div>
                                    <div class="modal-footer">
                                        <button type="button" data-dismiss="modal" class="btn btn-default">取消</button>
                                        <button type="button" class="btn btn-primary" id ="submit">确认</button>
                                    </div>
                                </div>
                            </div>
                        </div>


                        <div id="modal-add-department" tabindex="-1" role="dialog" aria-labelledby="modal-prompt-label" aria-hidden="true" class="modal fade" style="display: none;">
                            <div class="modal-dialog">
                                <div class="modal-content">
                                    <div class="modal-header">
                                        <button type="button" data-dismiss="modal" aria-hidden="true" class="close">×</button>
                                        <h4 id="modal-prompt-label" class="modal-title">新增部门</h4>
                                    </div>
                                    <div class="modal-body">
                                        <form action="{:U('Department/addDep')}" class="form-horizontal" method = "post">
                                            <div class="form-body pal">
                                                <div class="form-group">
                                                    <label for="studentID" class="col-md-3 control-label">部门名称</label>
                                                    <div class="col-md-9">
                                                        <div class="input-icon right">
                                                            <input id="studentID" type="text" placeholder="请输入新增部门的名称" class="form-control" style="height: 31px;font-size: 12px;-webkit-border-radius:4px !important;-moz-border-radius: 4px !important;border-radius: 4px !important" name = "new_name">
                                                        </div>
                                                    </div>
                                                    <label for="studentID" class="col-md-3 control-label">预计人数</label>
                                                    <div class="col-md-9">
                                                        <div class="input-icon right">
                                                            <input id="studentID" type="text" placeholder="请输入新增部门的预计人数" class="form-control" style="height: 31px;font-size: 12px;-webkit-border-radius:4px !important;-moz-border-radius: 4px !important;border-radius: 4px !important" onkeyup="this.value=this.value.replace(/\D/g,'')" onafterpaste="this.value=this.value.replace(/\D/g,'')" name ="pre_num">
                                                        </div>
                                                    </div>
                                                    <label for="studentID" class="col-md-3 control-label">部门简介</label>
                                                    <div class="col-md-9">
                                                        <div class="input-icon right">
                                                            <textarea rows="8" placeholder="简介" class="form-control" maxlength = "255" name = "new_intro"></textarea>
                                                        </div>
                                                    </div>
                                                
                                                </div>
                                            </div>
                                        
                                    </div>
                                    <div class="modal-footer">
                                        <button type="button" data-dismiss="modal" class="btn btn-default">取消</button>
                                        <button type="submit" class="btn btn-primary">确认</button>
                                    </div>
                                    </form>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    <include file="Layout:footer" />
    <script>
            (function(){
              var student, obj, ch;
              var text = ['name', 'gender', 'phone', 'academy'];
              $('#studentID').bind('input propertychange', function() {
                  student = $(this);
                  var id = student.val();
                  $.post('{:U("Department/searchMem")}', {studentID: id}).always(function(data, status) {
                      ch = student.closest('.form-group').nextAll();
                      ch.each(function(e) {
                          obj = $(this).find('.col-md-9');
                          obj.empty();
                          if(obj.val() === '') {
                              if(data == null) {
                                  obj.append('暂无信息');
                              } else {
                                  obj.append(data[text[e]]);
                              }
                          }
                      })
                  }).fail(function() {

                  })
              });
              $("#submit").click(function(){
                  var user_id=$("#studentID").val();
                  var department=$("#department").val();
                  var position=$("#position").val();
                  $.post("{:U('Department/addMem')}",
                          {
                              user_id:user_id,
                              department:department,
                              position:position
                          },
                          function(data,status){
                              if(data == 0) {
                                  alert('输入信息有误');
                              } else {
                                  alert(data);
                              }
                              parent.location.reload();
                          });
              });
            })();
    </script>